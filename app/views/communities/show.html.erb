
<h2>
Communities#show
</h2>

<h1><%= @community.title %></h1>

  <% if @community.is_public? %>
    Public <span class=""><b>
<% if CommunityJoinRequest.exists?(user_id: current_user.id, community_id: @community.id) %>
<button class="btn btn-outline-success" disabled>Joined</button>
<% else %>
  <%= form_for @join_request, url: community_community_join_requests_path(@community), method: :post do |f| %>
    <%= f.submit "Join", class: "btn btn-outline-dark" %>
  <% end %>
<% end %>
</b></span>
<% else %>

  Private <span class=""><b>
<% if CommunityJoinRequest.exists?(user_id: current_user.id, community_id: @community.id) %>
  <button class="btn btn-outline-dark" disabled>Request Submitted</button>
<% else %>
  <%= form_for @join_request, url: community_community_join_requests_path(@community), method: :post do |f| %>
    <%= f.submit "Join", class: "btn btn-outline-dark" %>
  <% end %>
<% end %>


</b></span>
<% end %>


 <hr> <ul>
  <li><%= @community.description %></li>

<% if @community.photos.attached? %>
  <% @community.photos.each do |photo| %>
    <%= cl_image_tag photo.key, class: "img-thumbnail", width: 200, crop: :thumb %>
  <% end %>
<% end %>



  <li><%= @community.category %></li>
  <li><%= @community.country %></li>
  <li><%= @community.city %></li>
  <li>Is public ?<%= @community.is_public %></li>
  <li>is visible ?<%= @community.is_visible %></li>

<hr>
<h2> Events:</h2>
              <div class="row">
    <% @events.each do |event| %>
      <div class="col-lg-3 my-3">
        <div class="card" style="width: 18rem; height: 22rem;">
          <div class="card-body position-relative">
            <h5 class="card-title"><%= event.title %></h5>
            <h6 class="card-subtitle mb-2 text-muted"></h6>
            <p class="card-text" style="position: absolute; bottom: 0; left: 0; margin: 8px;"><%= event.description %></p>
            <div class="d-flex justify-content-center" style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);">
              <%= event.capacity %>
            </div>
            <%= link_to "Details", community_event_path(@community, event), class: "btn btn-outline-dark position-absolute bottom-0 end-0 m-2" %>
          </div>
        </div>
      </div>
    <% end %>


<% if @community.user == current_user %>
<hr>
  <h2>Admin panel:</h2>
        <% if policy(@community).new? %>
          <%= link_to "Create Event", new_community_event_path(@community) %>
        <% end %>
        <% if policy(@community).edit? %>
          <%= link_to "Edit my commuinity", edit_community_path(@community) %>
        <% end %>

        <% if policy(@community).destroy? %>
  <%= link_to "Delete my community ", community_path(@community),   data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
        <% end %>
<% end %>
<hr>
<%= link_to "Back",  communities_path, class:"" %>
<%= link_to "Back",  communities_path, class:"" %>
